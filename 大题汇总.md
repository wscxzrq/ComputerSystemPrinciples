# 大题汇总

## 简答题

### 指令

指令是一串 0 / 1 序列，用来指示 CPU 完成特定的操作

### 指令系统

从具体问题到机器语言程序的每次转换都属于软件的范围，软硬件之间的桥梁就是指令体系结构，简称指令集架构或指令系统。它是软硬件之间接口的完整定义，ISA 定义了一套计算机可以执行的所有指令的集合，每条指令规定了计算机可以执行的操作，操作数的地址与类型，机器语言就是 ISA 规定的指令序列，因此，计算机执行机器语言的过程就是让其一条一条执行指令。

### 说明进位和溢出在概念和应用上的不同

进位：二进制加法运算时向更高位进位，最高位的进位常用于无符号数的加法时判断是否溢出

溢出：两个有符号数进行加减运算的结果超出了给定的取值范围，常用于带符号数运算

### 汉字字符编码有哪三类，简述各类编码的作用，并分别列举一个实际的作用

汉字的编码分为输入码，内码，输出字形码。输入码用于汉字信息的输入，例如拼音码；内码用于汉字信息在计算机内部的存储和处理，比如区位码；输出字形码用于汉字显示，比如字模点阵码

### 简述计算机中有多字节数据存储时，大端和小端存储方式的差异

大端方式是指数据的最高有效字节存放在最小地址单元，最低有效字节存放在最大地址单元

小端方式是指数据的最高有效字节存放在最大地址单元，最低有效字节存放在最小地址单元

### 在浮点数加减法中对阶的目的是什么？对阶的原则是什么

对阶的目的是使参加运算的两个数的阶码相等，以使它们的尾数可以直接相加减。

对阶的原则是小阶向大阶看齐，即小阶的那个数的尾数右移

### 浮点数加减运算需要经过哪几个主要步骤

对阶、尾数相加减、规格化、尾数舍入和溢出判断

### 过程的调用步骤

1. P 将入口参数放到 Q 能访问的地方
1. P 将返回地址存到特定的地方，然后将控制转移到 Q
1. Q 保存 P 的现场，并为自己的非静态局部变量分配空间
1. 执行 Q 的过程体
1. Q 恢复 P 的现场，并释放局部变量所占空间
1. Q 取出返回地址，将控制转移到 P

### i386 System V ABI对 struct 结构体数据的规则

1. 结构体的对齐方式跟它里面对齐要求**最严格的成员**相同。
1. 每个成员都要按照它自己的对齐要求，放到**满足对齐要求的最小位置**，这可能会导致**内部空隙**。
1. 结构体的总大小必须是**对齐边界的整数倍**，这可能会在结尾部分有**尾部空隙**。

### 可重定位目标文件和可执行目标文件的主要差别

可执行目标文件由链接器将多个可重定位文件组合生成。可重定位文件中的代码和数据地址是相对于起始地址0的，而可执行文件中的地址则按照操作系统的要求，重定位到运行时的虚拟内存中。

与可重定位文件相比，可执行文件的主要区别：

1. ELF头中的 `e_entry` 字段给出程序入口地址，而可重定位文件中这个字段是0。
1. 可执行文件多了 `.init` 节，包含 `_init` 函数，用于程序启动时的初始化。
1. 可执行文件少了 `.rel` 节，因为它的指令和数据已被重定位，不再需要重定位信息。
1. 增加了程序头表，定义了节与虚拟内存段的映射关系。

### 简述全局符号解析的规则

1. `强符号`不能多次定义，否则链接报错
1. 一次`强符号`，多次 `COMMON`符号或`弱符号`，以`强符号`为准
1. 同时出现 `COMMON` 和`弱符号`，以 `COMMON` 符号为准
1. 一个 `COMMON` 符号出现多次，以所占`空间最大`的为准
1. 若是用`-fno-common`选项，则将 `COMMON` 符号当做`强符号`

### CPU 对异常和中断的响应过程可分为三个步骤

保护断点和程序状态、关中断、识别异常和中断事件并转相应处理程序

### I/O 子系统工作过程

CPU在用户态运行用户进程时，遇到系统调用的陷阱指令，会从用户态切换到内核态。切换后，CPU根据EAX寄存器中的系统调用号执行相应的系统调用服务例程。服务例程中，可能需要调用设备驱动程序。设备驱动程序启动外设工作，当外设准备好数据后发出中断请求。CPU响应中断，调出中断服务程序，进行主机与设备间的数据交换。

### 指令ADD R2，(R1)中包含了哪些寻址方式?简述该指令的操作数的形成过程与功能

该指令中包含了寄存器寻址和寄存器间接寻址两种寻址方式。该指令的一个操作数在R2寄存器中，另一个操作数的地址在寄存器R1中：指令功能为将寄存器R2 中的值与内存地址 R1 所指向的值相加，结果存回寄存器 R2

寄存器寻址：操作数直接保存在寄存器中，指令中引用的寄存器就是操作数本身 R2

寄存器间接寻址：寄存器中存储的是一个内存地址，操作数保存在该内存地址所指向的内存单元中 R1

### CPU中设置的程序计数器(PC)和指令译码器(ID)的作用分别是什么?

程序计数器 (PC) 存放即将执行指令的地址，取指令时先将PC的内容发送到地址线；

指令译码器 (ID) 负责解析指令寄存器中的操作码，并生成相应的译码信号，供操作控制部件生成控制信号。

## 计算题

### 定点原码小数第一题：

设某机器子长为 32 位，数值位 31 位，符号位 1 位。定点原码小数表示时，最大正数（十进制）为多少？最小负数（十进制）为多少？

对于定点小数的表示，数值部分（不包括符号位）对应的是一个小于 1 的二进制分数。31 位的二进制小数从小数点开始，依次表示：

$b_1 \times 2^{-1} + b_2 \times 2^{-2} + b_3 \times 2^{-3} + …… b_{31} \times 2^{-31} $

其中$b_1,b_2,b_3 …… b_{31}$是二进制位可以是 0 或 1

**最大正数**：

当符号位为 0 其余 31 位全为 1 时

0.1111……1(31个 1)

转换为二进制

$1 \times 2^{-1} + 1 \times 2^{-2} + 1 \times 2^{-3} + …… 1 \times 2^{-31}$

可以看作是一个等比数列求和，使用等比数列求和公式

$S = 1 - 最小项$

$S = 1 - 2^{-31}$

**最小负数**：

符号位是 1，其余 31 位也是 1

$-(1 \times 2^{-1} + 1 \times 2^{-2} + 1 \times 2^{-3} + …… 1 \times 2^{-31})$

$S = -(1-2^{-31})$

### 设有一个存储器,其地址寄存器有16位,已知每个存储单元可存放8位二进制数。计算出该存储器的容量。若该存储器全部用于存放汉字信息,每个汉字采用内码方式存人,则该存储器可存入多少个汉字?

地址寄存器有 16 位，表示该存储器的地址范围为$2^{16}$个存储单元。

每个存储单元存放 8 位（1 字节）数据，因此存储器的总容量为：

$2^{16} \times 8 = 2^6 \times 2^{10} \times 8 = 65536 字节 = 64KB$

每个汉字采用内码方式存储，一般使用 2 个字节（16 位）表示一个汉字。

该存储器可以存储的汉字数量为：

$65536 \div 2 = 32768$个汉字

### 已知 Cache命中率 h=0.98，已知Cache存取周期为50ns，主存存取周期为200ns，求cache-主存层次的平均访问时间

cpu Cache 到主存的平均访问时间 = $T_c + (1 -  p) \times T_m$ = Cache 存取周期 + 未命中率 * 主存存取周期

$50 + 0.02  \times 200 = 54ns$



